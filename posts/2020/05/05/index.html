<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Vimspector: 最强 Vim 调试插件 - 孔俊的知识库</title><meta name=author content><meta name=author-link content><meta name=description content="vimspector是一个基于 DAP(debug adapter protocol) 的Vim多语言调试插件，理论上能够支持所有支持语言（只要有对应的 DAP）。这个插件仍在实验阶段，可能会有各种bug，但是对C/C++、Python 等流行的语言已经进行了充分的测试。 这篇文章以调试 C/C++ 程序为例，介绍 vimspector 的配置与使用。 dap 依赖 带 Python3.6+ 支持的 Vim 8.2 或更高版本 带 Python3.6+ 支持的 Neovim-0.4.3 或更高版本（最好是 Nightly 版本） 由于 vimspector 的作者主要在 GNU/Linux 上使用 Vim 开"><meta name=keywords content="Vim"><meta itemprop=name content="Vimspector: 最强 Vim 调试插件"><meta itemprop=description content="vimspector是一个基于 DAP(debug adapter protocol) 的Vim多语言调试插件，理论上能够支持所有支持语言（只要有对应的 DAP）。这个插件仍在实验阶段，可能会有各种bug，但是对C/C++、Python 等流行的语言已经进行了充分的测试。 这篇文章以调试 C/C++ 程序为例，介绍 vimspector 的配置与使用。 dap 依赖 带 Python3.6+ 支持的 Vim 8.2 或更高版本 带 Python3.6+ 支持的 Neovim-0.4.3 或更高版本（最好是 Nightly 版本） 由于 vimspector 的作者主要在 GNU/Linux 上使用 Vim 开"><meta itemprop=datePublished content="2020-05-05T16:14:32+08:00"><meta itemprop=dateModified content="2020-05-05T16:14:32+08:00"><meta itemprop=wordCount content="5209"><meta itemprop=image content="/posts/2020/05/05/images/featured-image.webp"><meta itemprop=keywords content="Vim,"><meta property="og:title" content="Vimspector: 最强 Vim 调试插件"><meta property="og:description" content="vimspector是一个基于 DAP(debug adapter protocol) 的Vim多语言调试插件，理论上能够支持所有支持语言（只要有对应的 DAP）。这个插件仍在实验阶段，可能会有各种bug，但是对C/C++、Python 等流行的语言已经进行了充分的测试。 这篇文章以调试 C/C++ 程序为例，介绍 vimspector 的配置与使用。 dap 依赖 带 Python3.6+ 支持的 Vim 8.2 或更高版本 带 Python3.6+ 支持的 Neovim-0.4.3 或更高版本（最好是 Nightly 版本） 由于 vimspector 的作者主要在 GNU/Linux 上使用 Vim 开"><meta property="og:type" content="article"><meta property="og:url" content="/posts/2020/05/05/"><meta property="og:image" content="/posts/2020/05/05/images/featured-image.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-05-05T16:14:32+08:00"><meta property="article:modified_time" content="2020-05-05T16:14:32+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/posts/2020/05/05/images/featured-image.webp"><meta name=twitter:title content="Vimspector: 最强 Vim 调试插件"><meta name=twitter:description content="vimspector是一个基于 DAP(debug adapter protocol) 的Vim多语言调试插件，理论上能够支持所有支持语言（只要有对应的 DAP）。这个插件仍在实验阶段，可能会有各种bug，但是对C/C++、Python 等流行的语言已经进行了充分的测试。 这篇文章以调试 C/C++ 程序为例，介绍 vimspector 的配置与使用。 dap 依赖 带 Python3.6+ 支持的 Vim 8.2 或更高版本 带 Python3.6+ 支持的 Neovim-0.4.3 或更高版本（最好是 Nightly 版本） 由于 vimspector 的作者主要在 GNU/Linux 上使用 Vim 开"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical href=/posts/2020/05/05/><link rel=prev href=/posts/2020/01/24/><link rel=next href=/posts/2021/03/15/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Vimspector: 最强 Vim 调试插件","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"\/posts\/2020\/05\/05\/"},"image":[{"@type":"ImageObject","url":"\/posts\/2020\/05\/05\/images\/featured-image.webp","width":941,"height":774}],"genre":"posts","keywords":"Vim","wordcount":5209,"url":"\/posts\/2020\/05\/05\/","datePublished":"2020-05-05T16:14:32+08:00","dateModified":"2020-05-05T16:14:32+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"孔俊"},"description":""}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title=孔俊的知识库><img loading=lazy src=/logo.svg srcset="/logo.svg, /logo.svg 1.5x, /logo.svg 2x" sizes=auto data-title=孔俊的知识库 data-alt=孔俊的知识库 class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>孔俊的知识库</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/posts/>文章</a></li><li class=menu-item><a class=menu-link href=/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/archives/>归档</a></li><li class=menu-item><a class=menu-link href=/about/>关于我</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=孔俊的知识库><img loading=lazy src=/logo.svg srcset="/logo.svg, /logo.svg 1.5x, /logo.svg 2x" sizes=auto data-title=/logo.svg data-alt=/logo.svg class=logo style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span class=header-title-text>孔俊的知识库</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=menu-item><a class=menu-link href=/posts/>文章</a></li><li class=menu-item><a class=menu-link href=/categories/>分类</a></li><li class=menu-item><a class=menu-link href=/tags/>标签</a></li><li class=menu-item><a class=menu-link href=/archives/>归档</a></li><li class=menu-item><a class=menu-link href=/about/>关于我</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span title=转载 class=icon-repost><i class="fa-solid fa-share fa-fw" aria-hidden=true></i></span><span>Vimspector: 最强 Vim 调试插件</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><span class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
孔俊</span></span>
<span class=post-category>收录于 <a href=/categories/vim/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Vim</a></span></div><div class=post-meta-line><span title="发布于 2020-05-05 16:14:32"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2020-05-05>2020-05-05</time></span>&nbsp;<span title="更新于 2020-05-05 16:14:32"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2020-05-05>2020-05-05</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 5209 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 11 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#依赖>依赖</a></li><li><a href=#安装>安装</a><ul><li><a href=#vimspector>vimspector</a></li><li><a href=#调试适配器>调试适配器</a></li></ul></li><li><a href=#配置>配置</a><ul><li><a href=#调试适配器配置>调试适配器配置</a></li><li><a href=#调试会话配置>调试会话配置</a></li><li><a href=#配置选项>配置选项</a></li></ul></li><li><a href=#变量>变量</a><ul><li><a href=#预定义变量>预定义变量</a></li><li><a href=#自定义变量>自定义变量</a></li><li><a href=#默认值>默认值</a></li><li><a href=#类型转换>类型转换</a></li></ul></li><li><a href=#多配置共存>多配置共存</a></li><li><a href=#断点>断点</a></li><li><a href=#示例>示例</a><ul><li><a href=#调试-vim>调试 Vim</a></li><li><a href=#调试-qemu-riscv64-中的-os-内核>调试 qemu-riscv64 中的 OS 内核</a></li><li><a href=#我自己的配置>我自己的配置</a></li></ul></li><li><a href=#使用技巧>使用技巧</a><ul><li><a href=#快捷键>快捷键</a></li><li><a href=#修改-ui>修改 UI</a></li><li><a href=#ballon-eval>Ballon-Eval</a></li><li><a href=#修改变量打印的格式>修改变量打印的格式</a></li></ul></li><li><a href=#题外话gdb-前端推荐>题外话：GDB 前端推荐</a></li></ul></nav></div></div><div class=content id=content><p><a href=https://github.com/puremourning/vimspector#supported-languages target=_blank rel="external nofollow noopener noreferrer">vimspector<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>是一个基于 <em>DAP(debug adapter protocol)</em> 的Vim多语言调试插件，理论上能够支持所有支持语言（只要有对应的 DAP）。这个插件仍在实验阶段，可能会有各种bug，但是对C/C++、Python 等流行的语言已经进行了充分的测试。</p><p>这篇文章以调试 C/C++ 程序为例，介绍 vimspector 的配置与使用。</p><p><figure><img src=images/with-dap.png alt=dap><figcaption>dap</figcaption></figure></p><h2 id=依赖>依赖</h2><ul><li>带 Python3.6+ 支持的 Vim 8.2 或更高版本</li><li>带 Python3.6+ 支持的 Neovim-0.4.3 或更高版本（最好是 Nightly 版本）</li></ul><p>由于 vimspector 的作者主要在 GNU/Linux 上使用 Vim 开发，因此 Vimspector 作者 puremourning 明确表示在 vimspector 的充分测试并稳定后才会提供对 Neovim 的完整支持（见 issue <a href=https://github.com/neoclide/coc.nvim/issues/322 target=_blank rel="external nofollow noopener noreferrer">coc.nvim: Debug Adapter Protocol Support #322<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>)，因此目前对于 Neovim 和 Windows 的支持都处于实验阶段。我个人建议在 Vim 中使用本插件。</p><h2 id=安装>安装</h2><h3 id=vimspector>vimspector</h3><p>使用<code>vim-plug</code>安装：</p><pre tabindex=0><code>Plug &#39;puremourning/vimspector&#39;
</code></pre><p>使用 dein.vim 安装：</p><pre tabindex=0><code>call dein#add(&#39;puremourning/vimspector&#39;）
</code></pre><h3 id=调试适配器>调试适配器</h3><p>最新版的 vimspector 可以在 Vim 中通过命令<code>:VimspectorInstall</code>安装调试适配器，按<code>Tab</code>键可以补全。</p><p>也可以使用安装脚本安装，进入<code>vimspector</code>的安装目录，执行：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./install_gadget.py &lt;language-name&gt;
</span></span></code></pre></div><p><code>install_gadget.py</code>会自动下载<code>&lt;language-name></code>所需的调试适配器并进行相应配置,<code>--help</code>可以查看<code>vimspector</code>所支持的全部语言。</p><p>以在Linux环境上打开C/C++支持为例：</p><pre tabindex=0><code>./install_gadget.py --enable-c
</code></pre><p><code>vimspector</code>会自动下载微软开发的调试适配器<code>cpptools-linux.vsix</code>到<code>your-vimspector-path/gadgets/linux/download/vscode-cpptools/0.27.0/</code>中。如果是在mac上，<code>linux</code>会被改成<code>mac</code>。</p><p>如果下载速度过慢，可以自己下载好放置在上面提到的目录中，然后再执行以上命令。</p><h2 id=配置>配置</h2><p>Vimspector 使用 json 作为配置文件的格式，每个配置都是一个 json 对象。</p><p>Vimpector 有两类配置：</p><ul><li><strong>调试适配器的配置</strong><ul><li>如何启动或连接到调试适配器</li><li>如何 attach 到某进程</li><li>如何设置远程调试</li></ul></li><li><strong>调试会话的配置</strong><ul><li>使用哪个调试适配器</li><li>launch 或 attach 到进程</li><li>是否预先设置断点，在何处设置断点</li></ul></li></ul><p>这两类配置可以对应多个配置文件，vimspector 会将多个配置文件中的信息合并成一个配置。</p><h3 id=调试适配器配置>调试适配器配置</h3><p>调试适配器的这个配置在打开 vimspector 对某语言的支持时就已经自动设置好了，存放在 your-path-to-vimspector/gadgets/linux/.gadgets.json 中。</p><p>比如在我的设备上，.gadgets.json 内容如下：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;adapters&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;vscode-cpptools&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;attach&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;pidProperty&#34;</span><span class=p>:</span> <span class=s2>&#34;processId&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;pidSelect&#34;</span><span class=p>:</span> <span class=s2>&#34;ask&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;command&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;${gadgetDir}/vscode-cpptools/debugAdapters/OpenDebugAD7&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>],</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;cppdbg&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>其中变量<code>${gadgetDir}</code>代表着存放 .gadgets.json 的目录。除此之外，vimspector 还定义了其他预定义变量，并提供了自定义和用户输入变量内容的功能，以便我们编写比较通用的配置文件。</p><p>调试适配器的配置还可以存在于其他配置文件中，vimspector 读取一系列配置文件，生成<code>adapters</code>对象。</p><p>调试适配器的配置可以存在于以下文件中：</p><ol><li><p>our-path-to-vimspector/gadgets/&lt;os>/.gadgets.json：这个文件由 install_gadget.py 自动生成，用户不应该修改它。</p></li><li><p>your-path-to-vimspector/gadgets/&lt;os>/.gadgets.d/*.json ：这些文件是用户自定义的。</p></li><li><p>在 Vim 工作目录向父目录递归搜索到的第一个 .gadgets.json。</p></li><li><p>.vimspector.json 中定义的<code>adapters</code>。</p></li></ol><p>编号代表配置文件的优先级，编号越大优先级越高，高优先级的配置文件将覆盖低优先级的配置文件中的的<code>adapters</code>。</p><p>在我的机器上没有 your-path-to-vimspector/gadgets/&lt;os>/.gadgets.d目录，可能是需要自己创建。</p><p>不进行远程调试的情况下不太需要修改默认的调试适配器配置。我一般没有进行远程调试的需求，没有实际使用过 vimspector 的远程调试功能（虽然这个功能是 vimspector 重点支持的），因此不介绍调试适配器的配置。</p><h3 id=调试会话配置>调试会话配置</h3><p>项目的调试会话的文件位于以下两个位置：</p><ol><li>&lt;your-path-to-vimspector>/configurations/&lt;os>/&lt;filetype>/*.json</li><li>项目根目录中的 .vimspector.json</li></ol><p>每当打开一个新的调试会话时，vimspector 都会在当前目录向父目录递归搜索，如果查找到了 .vimspector.json，则使用其中的配置，并将其所在的目录设定为项目根目录;如果未查找到，则使用 vimspector 安装目录中的配置文件，将打开的文件的目录设置为项目根目录。</p><p>修改了.vimspector.json 后不需要重启 Vim 就可以使用最新配置。</p><h3 id=配置选项>配置选项</h3><p>vimspector.json 中只能包含一个对象，其中包含以下子对象：</p><ul><li><code>adapters</code>：调试适配器配置，如果不是进行远程调试，一般不需要设置</li><li><code>configurations</code>：调试程序时的配置</li></ul><p><code>configurations</code>主要包含以下以下字段：</p><ul><li><code>adapter</code>:使用的调试配置器名称，该名称必须出现在<code>adapters</code>块或其他调试适配器配置中。</li><li><code>variables</code>：用户定义的变量</li><li><code>configuration</code>：配置名，如<code>configuration1</code></li><li><code>remote-request</code>,<code>remote-cmdLine</code>：远程调试使用</li></ul><p>其中<code>adapter</code>和<code>configuration</code>是必须的。</p><p><code>configuration</code>需要包含的字段和使用的 DAP 有关，我使用<a href=https://github.com/microsoft/vscode-cpptools target=_blank rel="external nofollow noopener noreferrer">vscode-cpptools<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>。<code>configuration</code>必须包含以下字段：</p><ul><li><code>request</code>：调试的类型，<code>lauch</code>或<code>attach</code></li><li><code>type</code>：<code>cppdgb</code>(GDB/LLDB)或<code>cppvsdbg</code>(Visutal Studio Windows debugger)</li></ul><p>除了以上的选项，还可以设置程序路径、参数、环境变量、调试器路径等，更详细的信息可以查看 vscode-cpptools 文档<a href=https://code.visualstudio.com/docs/cpp/launch-json-reference target=_blank rel="external nofollow noopener noreferrer">launch-json-reference<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>。</p><p>上面的选项构成了 vimspector 配置文件的主体框架，完整的选项参考<a href=https://puremourning.github.io/vimspector/schema/vimspector.schema.json target=_blank rel="external nofollow noopener noreferrer">vimspector.schema.json<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>。</p><h2 id=变量>变量</h2><p>Vimspector 提供了比较灵活的变量定义功能，可以方便的自定义配置。</p><h3 id=预定义变量>预定义变量</h3><p><figure><img src=images/predefined-variables.png alt="predefined variables"><figcaption>predefined variables</figcaption></figure></p><h3 id=自定义变量>自定义变量</h3><p>自定义变量要在起作用的配置中定义，并置于<code>variables</code>块中，如下面的<code>GDBServerVersion</code>和<code>SomeOtherVariable</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;configurations&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;some-configuration&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;variables&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;GDBServerVersion&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;shell&#34;</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;/path/to/my/scripts/get-gdbserver-version&#34;</span> <span class=p>],</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;env&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;SOME_ENV_VAR&#34;</span><span class=o>:</span> <span class=s2>&#34;Value used when running above command&#34;</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;SomeOtherVariable&#34;</span><span class=o>:</span> <span class=s2>&#34;some value&#34;</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>可以通过 shell 设置变量的值，代码块中的<code>GDBServerVersion</code>的值就是 shell 脚本<code>/path/to/my/scripts/get-gdbserver-version</code>的输出。</p><p>经我实验，自定义变量似乎不能够依赖自定义变量，也不可以在<code>shell</code>中使用预定义变量，可能之后的版本会实现这些功能。</p><p>也可以从用于输入中获取变量的值。只要 vimspector 发现了未定义的变量，就会在运行时提示用户输入变量值。Vimspector 支持 splat 运算符（不清楚中文叫什么），语法为<code>*${Variable}</code>，可以将一个变量拓展开。</p><p>以上两个特性结合在一起可以实现很灵活的配置，最典型的运例子是程序参数的传递。Vimspector 调试的程序的参数以数组的形式传递，在配置文件中将<code>args</code>设置为一个在运行时用户输入的变量，就可以模拟命令行的效果。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl>  <span class=s2>&#34;args&#34;</span><span class=o>:</span> <span class=p>[</span> <span class=s2>&#34;*${CommandLineArgs}&#34;</span> <span class=p>]</span>
</span></span></code></pre></div><p>在运行时 vimspector 会要求用户输入值，如果用户输入<code>1</code>、<code>2</code>、<code>3</code>,<code>args</code>就会被拓展成<code>["1", "2", "3"]</code>。</p><h3 id=默认值>默认值</h3><p>可以为变量提供默认值，<code>${variableName:default value}</code>。在<code>${}</code>中引用变量时，<code>}</code>要通过<code>\</code>转义，即将<code>}</code>写为<code>\\}</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;configuration&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;program&#34;</span><span class=p>:</span> <span class=s2>&#34;${script:${file\\}}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div><p><code>program</code>默认设置为变量<code>file</code>的值。</p><h3 id=类型转换>类型转换</h3><p>vimspector 介绍的的用户输入都字符串，有时会出现类型和用户期望的不同的情况。比如，用户为布尔类型的变量<code>StopOnEntry</code>输入<code>true</code>，vimspector 接收到字符串<code>"true"</code>，并将它赋给变量，这样出现了类型不一致的情况。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;configuration&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;stopAtEntry&#34;</span><span class=p>:</span> <span class=s2>&#34;${StopOnEntry}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div><p>在字段后添加<code>#json</code>可以将接收到的字符串转换成 json 里的类型。如果变量以<code>#json</code>结尾，需要在字段尾部添加<code>#s</code>以告知 Vimspector 这个变量以<code>#json</code>结尾，而不是进行类型转换。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;configuration&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;stopAtEntry#json&#34;</span><span class=p>:</span> <span class=s2>&#34;${StopOnEntry}&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span></code></pre></div><p>这样，用户输入<code>true</code>，vimspector 接收到字符串<code>"true"</code>，然后再将它解析为布尔类型的<code>true</code>。</p><h2 id=多配置共存>多配置共存</h2><p>可以在 .vimspector.vim 中写多个配置，在启动 vimspector 时再选择使用的配置。这样的话，可以将所有自己需要的配置写入到一个文件，在创建项目时复制到项目中。</p><p>和配置选择有关的字段有两个：</p><p><code>autoselect</code>: 布尔类型。在只有一个配置可用时，是否自动选择它。</p><p><code>default</code>: 布尔类型。当启动时用户没有选择配置时，使用本配置。</p><h2 id=断点>断点</h2><p>可以在配置中提前打好断点，比如在程序入口点暂停（通常是<code>main()</code>），在抛出异常时暂停等，暂时不支持在配置中，打函数、代码行断点</p><p><code>stopAtEntry</code>: 布尔类型。是否在程序入口点暂停。</p><p><code>cpp_throw</code>: 在抛出异常时暂停</p><p><code>cpp_catch</code>: 在捕获异常时暂停</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;example&#34;</span><span class=p>:{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;stopAtEntry&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;MIMode&#34;</span><span class=p>:</span> <span class=s2>&#34;gdb&#34;</span><span class=p>,</span>            <span class=c1>// 使用 GDB
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nt>&#34;breakpointers&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;exception&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=nt>&#34;cpp_throw&#34;</span><span class=p>:</span> <span class=s2>&#34;Y&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=nt>&#34;cpp_catch&#34;</span><span class=p>:</span> <span class=s2>&#34;N&#34;</span>
</span></span><span class=line><span class=cl>         <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>目前 Vimspector 对断点的支持还比较有限，仅支持打断点，不能够方便的编辑、禁用、使能断点，将来这些功能会实现在断点窗口中，参考<a href=https://github.com/puremourning/vimspector/issues/10 target=_blank rel="external nofollow noopener noreferrer">[Feature Request]: Breakpoints window #10<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>。</p><h2 id=示例>示例</h2><p>Vimspector 的配置其实很简单，但是纸上谈兵有些难以理解。这里将给出几个可以实际使用的配置，如调试 Vim、调试 qemu 模拟器中的 OS 内核。</p><h3 id=调试-vim>调试 Vim</h3><p>vimspector 文档中给出的调试vim的配置：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;configurations&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Vim - run a test&#34;</span><span class=o>:</span> <span class=p>{</span>                           <span class=c1>// 配置名
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=s2>&#34;adapter&#34;</span><span class=o>:</span> <span class=s2>&#34;vscode-cpptools&#34;</span><span class=p>,</span>                 <span class=c1>// 使用的调试适配器
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=s2>&#34;configuration&#34;</span><span class=o>:</span> <span class=p>{</span>                            <span class=c1>// 具体的配置
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;type&#34;</span><span class=o>:</span>    <span class=s2>&#34;cppdbg&#34;</span><span class=p>,</span>                        <span class=c1>// 调试器类型：cppdbg(GDB/LLDB) 或 cppvsdbg(VISUAL STUDIO)
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;request&#34;</span><span class=o>:</span> <span class=s2>&#34;launch&#34;</span><span class=p>,</span>                        <span class=c1>// 调试类型：launch（启动程序） 或 attach（连接进程）
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;program&#34;</span><span class=o>:</span> <span class=s2>&#34;${workspaceRoot}/src/vim&#34;</span><span class=p>,</span>      <span class=c1>// 带有调试信息的可执行文件目录
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;args&#34;</span><span class=o>:</span> <span class=p>[</span>                                   <span class=c1>// 程序的参数，一个 json 数组
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=s2>&#34;-f&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;-u&#34;</span><span class=p>,</span> <span class=s2>&#34;unix.vim&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;-U&#34;</span><span class=p>,</span> <span class=s2>&#34;NONE&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;--noplugin&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;--not-a-term&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;-S&#34;</span><span class=p>,</span> <span class=s2>&#34;runtest.vim&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=s2>&#34;${Test}.vim&#34;</span>                             <span class=c1>// 未定义的变量，用户输入
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;cwd&#34;</span><span class=o>:</span> <span class=s2>&#34;${workspaceRoot}/src/testdir&#34;</span><span class=p>,</span>      <span class=c1>// 当前工作目录
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;environment&#34;</span><span class=o>:</span> <span class=p>[</span>                            <span class=c1>// 环境变量
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=p>{</span> <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=s2>&#34;VIMRUNTIME&#34;</span><span class=p>,</span> <span class=s2>&#34;value&#34;</span><span class=o>:</span> <span class=s2>&#34;${workspaceRoot}/runtime&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>],</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;externalConsole&#34;</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>                    <span class=c1>// 是否使用外部终端
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;stopAtEntry&#34;</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>                        <span class=c1>// 是否在程序入口点暂停
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;MIMode&#34;</span><span class=o>:</span> <span class=s2>&#34;lldb&#34;</span><span class=p>,</span>                           <span class=c1>// 使用 LLDB 作为调试器
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=s2>&#34;logging&#34;</span><span class=o>:</span> <span class=p>{</span>                                <span class=c1>// 调试适配器的输出
</span></span></span><span class=line><span class=cl><span class=c1></span>          <span class=s2>&#34;engineLogging&#34;</span><span class=o>:</span> <span class=kc>false</span>                    <span class=c1>// 是否打印调试适配器产生的信息，默认不打印
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=调试-qemu-riscv64-中的-os-内核>调试 qemu-riscv64 中的 OS 内核</h3><p>用以下命令启动 qemu 模拟器，让它监听<code>localhost:1234</code>等待 GDB 连接：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl> qemu-system-riscv64 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>       -machine virt <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>       -s -S         <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>       -nographic    <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>       -bios default <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>       -device loader,file<span class=o>=</span>kernel.img,addr<span class=o>=</span>0x80200000
</span></span></code></pre></div><p>因此，我们要配置 vimspector 让 RISCV 架构的 GDB 连接到<code>localhost:1234</code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;configurations&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;qemu-riscv64-oslab&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;adapter&#34;</span><span class=p>:</span> <span class=s2>&#34;vscode-cpptools&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;variables&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;kernelBin&#34;</span><span class=p>:</span> <span class=s2>&#34;kernel.bin,                                // 带有调试信息的内核可执行文件
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>riscvGDB</span><span class=s2>&#34;: &#34;</span><span class=err>/usr/local/bin/riscv</span><span class=mi>64</span><span class=err>-unknown-elf-gdb</span><span class=s2>&#34;     // GDB 路径
</span></span></span><span class=line><span class=cl><span class=s2>            },
</span></span></span><span class=line><span class=cl><span class=s2>            &#34;</span><span class=err>configuration</span><span class=s2>&#34;: {
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>type</span><span class=s2>&#34;:    &#34;</span><span class=err>cppdbg</span><span class=s2>&#34;,
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>request</span><span class=s2>&#34;: &#34;</span><span class=err>launch</span><span class=s2>&#34;,
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>program</span><span class=s2>&#34;: &#34;</span><span class=err>$</span><span class=p>{</span><span class=err>kernelBin</span><span class=p>}</span><span class=s2>&#34;,
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>cwd</span><span class=s2>&#34;: &#34;</span><span class=err>$</span><span class=p>{</span><span class=err>workspaceRoot</span><span class=p>}</span><span class=s2>&#34;,
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>environment</span><span class=s2>&#34;: [],
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>externalConsole</span><span class=s2>&#34;: true,
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>stopAtEntry</span><span class=s2>&#34;: true,
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>MIMode</span><span class=s2>&#34;: &#34;</span><span class=err>gdb</span><span class=s2>&#34;,                                         // 使用 GDB
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>miDebuggerPath</span><span class=s2>&#34;: &#34;</span><span class=err>$</span><span class=p>{</span><span class=err>riscvGDB</span><span class=p>}</span><span class=s2>&#34;,                         // GDB 路径为 ${riscvGDB}
</span></span></span><span class=line><span class=cl><span class=s2>                &#34;</span><span class=err>setupCommands</span><span class=s2>&#34;: [                                       // 设置 GDB 初始化命令，相当于 gdbinit
</span></span></span><span class=line><span class=cl><span class=s2>                    {
</span></span></span><span class=line><span class=cl><span class=s2>                        &#34;</span><span class=err>description</span><span class=s2>&#34;: &#34;</span><span class=err>Enable</span> <span class=err>pretty-printing</span> <span class=err>for</span> <span class=err>gdb</span><span class=s2>&#34;, // 描述，不会被 GDB 使用
</span></span></span><span class=line><span class=cl><span class=s2>                        &#34;</span><span class=err>text</span><span class=s2>&#34;: &#34;</span><span class=err>set</span> <span class=err>architecture</span> <span class=err>riscv</span><span class=s2>&#34;,                // 命令
</span></span></span><span class=line><span class=cl><span class=s2>                        &#34;</span><span class=err>ignoreFailures</span><span class=s2>&#34;: false                          // 是否忽略错误
</span></span></span><span class=line><span class=cl><span class=s2>                    },
</span></span></span><span class=line><span class=cl><span class=s2>                    {
</span></span></span><span class=line><span class=cl><span class=s2>                        &#34;</span><span class=err>description</span><span class=s2>&#34;: &#34;</span><span class=err>Connect</span> <span class=err>gdbserver</span> <span class=err>within</span> <span class=err>qemu</span><span class=s2>&#34;,
</span></span></span><span class=line><span class=cl><span class=s2>                        &#34;</span><span class=err>text</span><span class=s2>&#34;: &#34;</span><span class=err>target</span> <span class=err>remote</span> <span class=err>localhost</span><span class=p>:</span><span class=mi>1234</span><span class=s2>&#34;,
</span></span></span><span class=line><span class=cl><span class=s2>                        &#34;</span><span class=err>ignoreFailures&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=err>]</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=err>}</span>
</span></span></code></pre></div><p>上面的配置依赖 vscode-cpptools，不支持其他的调试适配器。</p><h3 id=我自己的配置>我自己的配置</h3><p>我将我可能使用的配置写入到一个文件，这样不需要重复编写，在启动 vimspector 选择即可。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;configurations&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                                                                   <span class=c1>// 上面介绍过了，不再赘述
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nt>&#34;qemu-riscv64-oslab&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;launch-current-file&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;adapter&#34;</span><span class=p>:</span> <span class=s2>&#34;vscode-cpptools&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;configuration&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;default&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;type&#34;</span><span class=p>:</span>    <span class=s2>&#34;cppdbg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;request&#34;</span><span class=p>:</span> <span class=s2>&#34;launch&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;program&#34;</span><span class=p>:</span> <span class=s2>&#34;${fileDirname}/${fileBasenameNoExtension}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;*${ProgramArgs}&#34;</span><span class=p>],</span>                      <span class=c1>// 用户输入
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=nt>&#34;cwd&#34;</span><span class=p>:</span> <span class=s2>&#34;${workspaceRoot}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;environment&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;externalConsole&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;stopAtEntry&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;MIMode&#34;</span><span class=p>:</span> <span class=s2>&#34;gdb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;breakpointers&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;exception&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cpp_throw&#34;</span><span class=p>:</span> <span class=s2>&#34;Y&#34;</span><span class=p>,</span>                          <span class=c1>// 抛出异常时暂停
</span></span></span><span class=line><span class=cl><span class=c1></span>                        <span class=nt>&#34;cpp_catch&#34;</span><span class=p>:</span> <span class=s2>&#34;N&#34;</span>                           <span class=c1>// 捕获时不暂停
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;launch-current-project&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;adapter&#34;</span><span class=p>:</span> <span class=s2>&#34;vscode-cpptools&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;configuration&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;variables&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;ProgramName&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;shell&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;basename &#34;</span><span class=p>,</span> <span class=s2>&#34;${workspaceRoot}&#34;</span><span class=p>]</span> <span class=c1>// 无法正确执行，需要用户输入
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;ProgramPath&#34;</span><span class=p>:</span> <span class=s2>&#34;${workspaceRoot}/_builds/${ProgramName}&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;type&#34;</span><span class=p>:</span>    <span class=s2>&#34;cppdbg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;request&#34;</span><span class=p>:</span> <span class=s2>&#34;launch&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;program&#34;</span><span class=p>:</span> <span class=s2>&#34;${workspaceRoot}/_builds/${ProgramName}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;args&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;*${ProgramArgs}&#34;</span><span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;cwd&#34;</span><span class=p>:</span> <span class=s2>&#34;${workspaceRoot}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;environment&#34;</span><span class=p>:</span> <span class=p>[],</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;externalConsole&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;stopAtEntry&#34;</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;MIMode&#34;</span><span class=p>:</span> <span class=s2>&#34;gdb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;breakpointers&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;exception&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cpp_throw&#34;</span><span class=p>:</span> <span class=s2>&#34;Y&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cpp_catch&#34;</span><span class=p>:</span> <span class=s2>&#34;N&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;attach-current-file&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;adapter&#34;</span><span class=p>:</span> <span class=s2>&#34;vscode-cpptools&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;configuration&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;cppdbg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;request&#34;</span><span class=p>:</span> <span class=s2>&#34;attach&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;program&#34;</span><span class=p>:</span> <span class=s2>&#34;${fileDirname}/${fileBasenameNoExtension}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;MIMode&#34;</span><span class=p>:</span> <span class=s2>&#34;gdb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;breakpointers&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;exception&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cpp_throw&#34;</span><span class=p>:</span> <span class=s2>&#34;Y&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cpp_catch&#34;</span><span class=p>:</span> <span class=s2>&#34;N&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=nt>&#34;attach-current-project&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;adapter&#34;</span><span class=p>:</span> <span class=s2>&#34;vscode-cpptools&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;configuration&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;variables&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;ProgramName&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;shell&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;basename&#34;</span><span class=p>,</span> <span class=s2>&#34;${workspaceRoot}&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=p>},</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;ProgramPath&#34;</span><span class=p>:</span> <span class=s2>&#34;${workspaceRoot}/_builds/${ProgramName}&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>},</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;cppdbg&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;request&#34;</span><span class=p>:</span> <span class=s2>&#34;attach&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;program&#34;</span><span class=p>:</span> <span class=s2>&#34;${ProgramPath}&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;MIMode&#34;</span><span class=p>:</span> <span class=s2>&#34;gdb&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nt>&#34;breakpointers&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;exception&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cpp_throw&#34;</span><span class=p>:</span> <span class=s2>&#34;Y&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nt>&#34;cpp_catch&#34;</span><span class=p>:</span> <span class=s2>&#34;N&#34;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><figure><img src=images/vimspector-screenshot.gif alt=vimspector-screenshot><figcaption>vimspector-screenshot</figcaption></figure></p><h2 id=使用技巧>使用技巧</h2><h3 id=快捷键>快捷键</h3><p>Vimspector 预设了vscode mode 和 human mode 两套键盘映射（快捷键）。</p><p>但是对C/C++、Python 等流行的语言已经进行了充分的测试。开启vscode mode：</p><pre tabindex=0><code>let g:vimspector_enable_mappings = &#39;VISUAL_STUDIO&#39;
</code></pre><p>开启 human mode：</p><pre tabindex=0><code>let g:vimspector_enable_mappings = &#39;HUMAN&#39;
</code></pre><p><figure><img src=images/mappings.png alt=mappings><figcaption>mappings</figcaption></figure></p><p>这两个套快捷键都要用到 F11 和 F12，往往会和终端快捷键冲突，比如 F11 是最大化终端，F12 是弹出 guake 之类的下拉框终端，建议终端用户重新定义快捷键。参考快捷键：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F1</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>Stop</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F2</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>Restart</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F3</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>Continue</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F4</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>Pause</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F5</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>RunToCursor</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F6</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>ToggleBreakpoint</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>Leader</span><span class=p>&gt;&lt;</span><span class=nx>F6</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>ListBreakpoints</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F7</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=p>&lt;</span><span class=nx>SID</span><span class=p>&gt;</span><span class=nx>toogle_conditional_breakpoint</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F8</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>StepOver</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F9</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>StepInto</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>nnoremap</span> <span class=p>&lt;</span><span class=nx>silent</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nx>F10</span><span class=p>&gt;</span> :<span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>StepOut</span><span class=p>()&lt;</span><span class=nx>CR</span><span class=p>&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>function</span><span class=p>!</span> <span class=nx>s</span>:<span class=nx>toogle_conditional_breakpoint</span><span class=p>()</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>condition</span> <span class=p>=</span> <span class=nx>trim</span><span class=p>(</span><span class=nx>input</span><span class=p>(</span><span class=s2>&#34;Condition: &#34;</span><span class=p>))</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>if</span> <span class=nx>empty</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>condition</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=nx>return</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>endif</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>let</span> <span class=nx>l</span>:<span class=nx>count</span> <span class=p>=</span> <span class=nx>trim</span><span class=p>(</span><span class=nx>input</span><span class=p>(</span><span class=s2>&#34;Count: &#34;</span><span class=p>))</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>if</span> <span class=nx>empty</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>count</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=k>let</span> <span class=nx>l</span>:<span class=nx>count</span> <span class=p>=</span> <span class=m>1</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>else</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=k>let</span> <span class=nx>l</span>:<span class=nx>count</span> <span class=p>=</span> <span class=nx>str2nr</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>count</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>endif</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=nx>call</span> <span class=nx>vimspector</span>#<span class=nx>ToggleBreakpoint</span><span class=p>(</span>{<span class=s1>&#39;condition&#39;</span>: <span class=nx>l</span>:<span class=nx>condition</span><span class=p>,</span> <span class=s1>&#39;hitCondition&#39;</span>: <span class=nx>l</span>:<span class=nx>count</span>}<span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>endfunction</span><span class=err>
</span></span></span></code></pre></div><h3 id=修改-ui>修改 UI</h3><p>Vimspector 的 UI 是针对宽屏设计的，对于笔记本屏幕可能不太友好，最主要的问题是 console 窗口挤占了源代码窗口的空间，可以在启动时关闭 console 窗口，需要时再使用<code>:VimspectorShowOutput Console</code>显示。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>augroup</span> <span class=nx>MyVimspectorUICustomistaion</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>  <span class=nx>autocmd</span> <span class=nx>User</span> <span class=nx>VimspectorUICreated</span> <span class=nx>call</span> <span class=p>&lt;</span><span class=nx>SID</span><span class=p>&gt;</span><span class=nx>vimspector_custom_ui</span><span class=p>()</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>augroup</span> <span class=nx>END</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>&#34; Custom Vimspector UI</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c>&#34; close console window to maximise source code window</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>function</span> <span class=nx>s</span>:<span class=nx>vimspector_custom_ui</span><span class=p>()</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>if</span> <span class=p>!</span><span class=nx>getwinvar</span><span class=p>(</span><span class=nx>g</span>:<span class=nx>vimspector_session_windows</span>.<span class=nx>output</span><span class=p>,</span> <span class=s1>&#39;&amp;hidden&#39;</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=k>let</span> <span class=nx>l</span>:<span class=nx>winid</span> <span class=p>=</span> <span class=nx>win_getid</span><span class=p>()</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=k>let</span> <span class=nx>l</span>:<span class=nx>cursor</span> <span class=p>=</span> <span class=nx>getcurpos</span><span class=p>()</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=nx>call</span> <span class=nx>win_gotoid</span><span class=p>(</span><span class=nx>g</span>:<span class=nx>vimspector_session_windows</span>.<span class=nx>output</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        :<span class=nx>quit</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=nx>call</span> <span class=nx>win_gotoid</span><span class=p>(</span><span class=nx>l</span>:<span class=nx>winid</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>        <span class=nx>call</span> <span class=nx>setpos</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>,</span> <span class=nx>l</span>:<span class=nx>cursor</span><span class=p>)</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span>    <span class=k>endif</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>endfunction</span><span class=err>
</span></span></span></code></pre></div><p>调整 UI 的具体细节可以参考文档。</p><h3 id=ballon-eval>Ballon-Eval</h3><p>当鼠标悬浮在变量上时，Vimspector 会自动打印变量的类型与值，这个功能 依赖于 ballon-eval（help），仅支持 GVim，但 Vim 最好也开启 ballon-eval 支持。如果不使用 GVim，可以使用以下映射手动查看变量的值。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-vim data-lang=vim><span class=line><span class=cl><span class=nx>nmap</span> <span class=p>&lt;</span><span class=nx>Leader</span><span class=p>&gt;</span><span class=nx>di</span> <span class=p>&lt;</span><span class=nx>Plug</span><span class=p>&gt;</span><span class=nx>VimspectorBalloonEval</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=nx>xmap</span> <span class=p>&lt;</span><span class=nx>Leader</span><span class=p>&gt;</span><span class=nx>di</span> <span class=p>&lt;</span><span class=nx>Plug</span><span class=p>&gt;</span><span class=nx>VimspectorBalloonEval</span><span class=err>
</span></span></span></code></pre></div><h3 id=修改变量打印的格式>修改变量打印的格式</h3><p>在 watch 窗口中输入变量名时在后面加上<code>,format</code>可以修改打印格式，目前使用 vscode-cpptools 似乎只能使用<code>,x</code>（十六进制）和<code>,o</code>（八进制）。</p><h2 id=题外话gdb-前端推荐>题外话：GDB 前端推荐</h2><p>参考<a href=https://www.zhihu.com/people/skywind3000 target=_blank rel="external nofollow noopener noreferrer">韦易笑<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>的文章<a href=https://zhuanlan.zhihu.com/p/32843449 target=_blank rel="external nofollow noopener noreferrer">终端调试哪家强<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>，尝试了几种 C/C++ 调试方案，得到以下结论：</p><p>裸 GDB ==> cgdb ==> Vimspector/VSCode ==> gdbgui</p><p>其中 Vimspector 和 VSCode 均使用 vscode-cpptools，个人认为在能力上没有太大区别。<a href=https://github.com/cs01/gdbgui target=_blank rel="external nofollow noopener noreferrer">gdbgui<i class="fa-solid fa-external-link-alt fa-fw fa-xs ms-1 text-secondary" aria-hidden=true></i></a>是一个基于浏览器的 GDB 前端，能力应该是上述几种方案中最强的。gdbgui 有以下几个突出特性：</p><ul><li>不需要配置
gdbgui 不需要配置，只需要像直接使用 gdb 一样输入命令即可，如<code>gdbgui -g 'gdb program -x gdbinit'</code>。</li><li>兼顾 GUI 和命令行
在 gdbgui 中可以直接在 gdb 命令行中输入命令，并且 GUI 会响应 gdb 命令。比如在命令行中打了断点，GUI 会立刻显示出来。</li><li>图形化显示数据结构
GDB 可以图形化显示链表和树</li></ul><p>Vimspector 仍在实验阶段，部分重要特性还没有实现，如果需要更加强大的调试功能，可以考虑 gdbgui。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2020-05-05 16:14:32">更新于 2020-05-05&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=/posts/2020/05/05/ data-title="Vimspector: 最强 Vim 调试插件" data-hashtags=Vim><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=/posts/2020/05/05/ data-hashtag=Vim><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=/posts/2020/05/05/ data-title="Vimspector: 最强 Vim 调试插件"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/vim/ class=post-tag>Vim</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/2020/01/24/ class=post-nav-item rel=prev title="C/C++ 的严格别名规则"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>C/C++ 的严格别名规则</a>
<a href=/posts/2021/03/15/ class=post-nav-item rel=next title="用 Vim 搭建开发环境">用 Vim 搭建开发环境<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-reward><div class=comment></div><input type=checkbox class=reward-input name=reward id=fi-reward hidden>
<label class=reward-button for=fi-reward>赞赏</label><div class=reward-ways data-mode=static><div><img loading=lazy src=/alipay.jpg srcset="/alipay.jpg, /alipay.jpg 1.5x, /alipay.jpg 2x" sizes=auto data-title="孔俊 支付宝" data-alt="孔俊 支付宝" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>支付宝</span></div><div><img loading=lazy src=/wechatpay.png srcset="/wechatpay.png, /wechatpay.png 1.5x, /wechatpay.png 2x" sizes=auto data-title="孔俊 微信" data-alt="孔俊 微信" style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'><span>微信</span></div></div></div><div id=comments><div id=giscus><script src=https://giscus.app/client.js data-repo=kongjun18/kongjun18.github.io data-repo-id=R_kgDOICeqmQ data-category=Announcements data-category-id=DIC_kwDOICeqmc4CVeTb data-mapping=pathname data-strict=0 data-theme=preferred_color_scheme data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-lang=zh-CN data-loading=lazy crossorigin=anonymous async defer></script></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://giscus.app/ rel="external nofollow noopener noreferrer">giscus</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.110.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.18"><img class=fixit-icon src=/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=/></a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line statistics"></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/kongjun18/blog title=查看博客源代码 target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pangu/pangu.min.js defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:40},comment:{enable:!0,expired:!1,giscus:{darkTheme:"dark_dimmed",lightTheme:"light"}},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},pangu:{enable:!0,selector:"article"}}</script><script src=/js/theme.min.js defer></script></body></html>